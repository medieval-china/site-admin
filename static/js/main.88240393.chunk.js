(this["webpackJsonpmedieval-china-admin"]=this["webpackJsonpmedieval-china-admin"]||[]).push([[0],{106:function(e,t,n){},181:function(e,t,n){},182:function(e,t,n){},183:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(10),c=n.n(r),s=(n(106),n(15)),o=n(84),u=n(233),l=n(227),d=n(226),h=n(228),j=n(221),f=n(229),v=n(85),m=n.n(v),p=n(184),b=n(224),O=n(225),g=n(232),y=n(230),x=n(25),w=n.n(x),D=n(4);function C(){return Object(D.jsxs)(p.a,{variant:"body2",color:"textSecondary",align:"center",children:["Copyright \xa9 ",Object(D.jsx)(j.a,{color:"inherit",href:"http://medieval-china.github.io/",children:"Medieval-China"})," ",(new Date).getFullYear(),"."]})}function N(e){return Object(D.jsx)(y.a,Object(o.a)({elevation:6,variant:"filled"},e))}var P=Object(b.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));function Y(e){var t=P(),n=Object(a.useState)({open:!1,severity:"warning",message:""}),i=Object(s.a)(n,2),r=i[0],c=i[1],o=Object(a.useState)(),j=Object(s.a)(o,2),v=j[0],b=j[1],y=Object(a.useState)(),x=Object(s.a)(y,2),Y=x[0],S=x[1],k=function(){c({open:!1,severity:r.severity,message:""})};return Object(D.jsxs)(O.a,{component:"main",maxWidth:"xs",children:[Object(D.jsx)(d.a,{}),Object(D.jsxs)("div",{className:t.paper,children:[Object(D.jsx)(u.a,{className:t.avatar,children:Object(D.jsx)(m.a,{})}),Object(D.jsx)(p.a,{component:"h1",variant:"h5",children:"Sign in"}),Object(D.jsxs)("form",{className:t.form,noValidate:!0,onSubmit:function(t,n){if(t.preventDefault(),v)if(Y){var a=w()().format("YYYYMMDD");"admin"===v&&Y===a?(c({open:!0,severity:"success",message:"\u767b\u5f55\u6210\u529f\uff5e"}),e.onLogin&&e.onLogin()):c({open:!0,severity:"warning",message:"\u8d26\u53f7\u540d\u6216\u5bc6\u7801\u9519\u8bef"})}else c({open:!0,severity:"warning",message:"\u8bf7\u8f93\u5165\u5bc6\u7801"});else c({open:!0,severity:"warning",message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"})},children:[Object(D.jsx)(h.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"username",label:"User Name",name:"username",autoComplete:"username",placeholder:"admin",onChange:function(e){return b(e.target.value)},autoFocus:!0}),Object(D.jsx)(h.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",onChange:function(e){return S(e.target.value)}}),Object(D.jsx)(l.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:t.submit,children:"Sign In"})]})]}),Object(D.jsx)(f.a,{mt:8,children:Object(D.jsx)(C,{})}),Object(D.jsx)(g.a,{anchorOrigin:{vertical:"top",horizontal:"center"},autoHideDuration:1500,open:r.open,onClose:k,message:r.message,children:Object(D.jsxs)(N,{onClose:k,severity:r.severity,children:[r.message,"!"]})})]})}var S,k=n(223),E=n(88),M=n.n(E),T=n(39),R=n(55),V=n(56),L=n(58),K=n(57),X=n(86),A=n.n(X),W=n(87),q=n.n(W),I=function(e,t,n,a,i){a=a||0,i=i||0,this.identifier=t,this.target=e,this.clientX=n.clientX+a,this.clientY=n.clientY+i,this.screenX=n.screenX+a,this.screenY=n.screenY+i,this.pageX=n.pageX+a,this.pageY=n.pageY+i};function B(){var e=[];return e.item=function(e){return this[e]||null},e.identifiedTouch=function(e){return this[e+1]||null},e}function F(e){return function(t){1===t.which&&(("mousedown"===t.type||!S||S&&!S.dispatchEvent)&&(S=t.target),function(e,t){var n=document.createEvent("Event");n.initEvent(e,!0,!0),n.altKey=t.altKey,n.ctrlKey=t.ctrlKey,n.metaKey=t.metaKey,n.shiftKey=t.shiftKey,n.touches=Q(t),n.targetTouches=Q(t),n.changedTouches=U(t),S.dispatchEvent(n)}(e,t),"mouseup"===t.type&&(S=null))}}function U(e){var t=B();return t.push(new I(S,1,e,0,0)),t}function Q(e){return"mouseup"===e.type?B():U(e)}function z(e){!function(){for(var e=[window,document.documentElement],t=["ontouchstart","ontouchmove","ontouchcancel","ontouchend"],n=0;n<e.length;n++)for(var a=0;a<t.length;a++)e[n]&&void 0===e[n][t[a]]&&(e[n][t[a]]=null)}(),e.addEventListener("mousedown",F("touchstart"),!0),e.addEventListener("mousemove",F("touchmove"),!0),e.addEventListener("mouseup",F("touchend"),!0)}z.multiTouchOffset=75;var J=z,H=function(e){Object(L.a)(n,e);var t=Object(K.a)(n);function n(){var e;Object(R.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).id="c".concat(Math.random().toString(36).substring(7)),e.state={isRender:!1},e.chart=null,e.init=function(t){var n=e.props,a=n.width,i=void 0===a?t.width:a,r=n.height,c=void 0===r?t.height:r,s=n.creator,o=n.data,u=new A.a.Chart({id:e.id,width:i,height:c,pixelRatio:window.devicePixelRatio,appendPadding:[10,20,6,0]});s({chart:u,data:o,alias:o.alias}),e.chart=u},e.getParentRect=function(){var t=e.canvas.parentElement;if(t){var n=t.getBoundingClientRect(),a=n.width,i=n.height;return J(e.canvas),e.setState({isRender:!0}),{width:a,height:i}}return e.setState({isRender:!1}),{}},e}return Object(V.a)(n,[{key:"componentDidMount",value:function(){var e=this.getParentRect(),t=e.width,n=e.height;this.init({width:t,height:n})}},{key:"componentDidUpdate",value:function(){if(this.state.isRender){var e=this.getParentRect(),t=e.width,n=e.height;this.init({width:t,height:n})}}},{key:"componentWillUnmount",value:function(){this.chart.destroy(),this.chart=null}},{key:"shouldComponentUpdate",value:function(e){var t=!q()(this.props.data,e.data);return console.log("shouldComponentUpdate:",t),t}},{key:"render",value:function(){var e=this;return Object(D.jsx)("canvas",{id:this.id,ref:function(t){e.canvas=t}})}}]),n}(a.Component),G="100%",Z="100%",$=function(e){Object(L.a)(n,e);var t=Object(K.a)(n);function n(){var e;Object(R.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).creator=function(e){var t,n=e.chart,a=e.data,i=e.alias,r=a.source,c=a.position,o=c.split("*"),u=Object(s.a)(o,2),l=u[0],d=u[1];n.clear(),n.source(r,(t={},Object(T.a)(t,l,{type:"timeCat",mask:"MM/DD",tickCount:7,range:[0,1]}),Object(T.a)(t,d,{tickCount:6,min:0,alias:i.y}),t)),n.tooltip({showCrosshairs:!0}),n.line().position(c).shape("smooth").color("#3da742"),n.point().position(c).shape("smooth").color("#3da742").style({stroke:"#fff",lineWidth:1}),n.render()},e}return Object(V.a)(n,[{key:"render",value:function(){var e=this.props,t=e.source,n=void 0===t?[]:t,a=e.position,i=e.width,r=e.height,c=e.alias,s=void 0===c?{}:c,o={width:i||G,height:r||Z};return Object(D.jsx)("div",{className:"jsChartWrap",style:o,children:Object(D.jsx)(H,{data:{source:n,position:a,alias:s},creator:this.creator})})}}]),n}(a.PureComponent),_=n(59);function ee(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7,t=[],n=e;n>0;n--){var a=w()().subtract(n,"day");t.push({start:a.startOf("date"),end:a.endOf("date")})}return t}var te=window.AV,ne="RE2X3iYzmzwAjkv8WXLYyf1e-MdYXbMMI",ae="yv3AoBegr8qvDisOGH4JqS8y",ie="https://us.leancloud.cn/";function re(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(t.require,t.startDate),a=t.endDate,i=[],r=new te.Query(e).notEqualTo("objectId","");if(i.push(r),n){var c=new te.Query(e);c.greaterThanOrEqualTo("createdAt",new Date(n)),i.push(c)}if(a){var s=new te.Query(e);s.lessThan("createdAt",new Date(a)),i.push(s)}return i}function ce(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.startDate,a=t.endDate,i=re("Counter",{startDate:n,endDate:a}),r=(e=te.Query).and.apply(e,Object(_.a)(i));return new Promise((function(e,t){r.count().then((function(t){return e(t)}),(function(e){return t(e)}))}))}function se(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.startDate,a=t.endDate,i=re("Comment",{startDate:n,endDate:a}),r=(e=te.Query).and.apply(e,Object(_.a)(i));return new Promise((function(e,t){r.count().then((function(t){return e(t)}),(function(e){return t(e)}))}))}te.init({appId:ne,appKey:ae,serverURLs:ie});n(181);var oe=Object(b.a)((function(e){return{refreshBtn:{position:"absolute",right:0,top:0}}}));function ue(){var e=Object(a.useState)(0),t=Object(s.a)(e,2),n=t[0],i=t[1],r=Object(a.useState)(0),c=Object(s.a)(r,2),o=c[0],u=c[1],l=Object(a.useState)(0),d=Object(s.a)(l,2),h=d[0],j=d[1],f=Object(a.useState)(0),v=Object(s.a)(f,2),m=v[0],p=v[1],b=Object(a.useState)([]),O=Object(s.a)(b,2),g=O[0],y=O[1],x=Object(a.useState)([]),C=Object(s.a)(x,2),N=C[0],P=C[1],Y=Object(a.useState)(null),S=Object(s.a)(Y,2),E=S[0],T=S[1],R=oe();Object(a.useEffect)((function(){var e=[w()().startOf("date").format(),w()().endOf("date").format()];ce().then((function(e){console.log("\u603bPV:",e),i(e)})),se().then((function(e){console.log("\u603b\u8bc4\u8bba:",e),u(e)})),ce({startDate:e[0],endDate:e[1]}).then((function(e){console.log("\u4eca\u65e5PV:",e),j(e)})),se({startDate:e[0],endDate:e[1]}).then((function(e){console.log("\u4eca\u65e5\u8bc4\u8bba:",e),p(e)})),setTimeout((function(){(function(){var e=ee(arguments.length>0&&void 0!==arguments[0]?arguments[0]:7),t=[];return e.forEach((function(e,n){var a=e.start,i=e.end,r=a.format(),c=i.format(),s=ce({startDate:r,endDate:c});t.push(s.then((function(e){return{startDate:r,endDate:c,date:a.format("YYYY-MM-DD"),pv:e}})).catch((function(e){console.error("\u7edf\u8ba1pv\u9519\u8bef\uff1a",e)})))})),Promise.all(t).then((function(e,t){return e}))})().then((function(e){console.log("7\u65e5PV:",e),y(e.filter((function(e){return e})))}))}),200),setTimeout((function(){(function(){var e=ee(),t=[];return e.forEach((function(e){var n=e.start,a=e.end,i=n.format(),r=a.format(),c=se({startDate:i,endDate:r});t.push(c.then((function(e){return{startDate:i,endDate:r,date:n.format("YYYY-MM-DD"),count:e}})).catch((function(e){console.error("\u7edf\u8ba1\u8bc4\u8bba\u9519\u8bef\uff1a",e)})))})),Promise.all(t).then((function(e,t){return e}))})().then((function(e){console.log("7\u65e5\u8bc4\u8bba:",e),P(e.filter((function(e){return e})))}))}),600)}),[E]);return Object(D.jsxs)("div",{className:"dashboard-wrapper",children:[Object(D.jsx)("div",{className:"title",children:Object(D.jsx)("h2",{children:"\u540e\u53f0\u6570\u636e - \u4e2d\u56fd\u7684\u4e2d\u53e4"})}),Object(D.jsxs)("div",{className:"overview block-item",children:[Object(D.jsx)("h3",{children:"\u603b\u89c8"}),Object(D.jsxs)("div",{className:"line",children:["\u603bPV: ",Object(D.jsx)("span",{className:"count",children:n})]}),Object(D.jsxs)("div",{className:"line",children:["\u603b\u8bc4\u8bba\u6570: ",Object(D.jsx)("span",{className:"count",children:o})]}),Object(D.jsxs)("div",{className:"line",children:["\u5f53\u65e5\u5b9e\u65f6PV: ",Object(D.jsx)("span",{className:"count",children:h})]}),Object(D.jsxs)("div",{className:"line",children:["\u5f53\u65e5\u5b9e\u65f6\u8bc4\u8bba\u6570: ",Object(D.jsx)("span",{className:"count",children:m})]}),Object(D.jsx)("div",{className:R.refreshBtn,children:Object(D.jsx)(k.a,{"aria-label":"delete",onClick:function(){T(Math.random())},children:Object(D.jsx)(M.a,{})})})]}),Object(D.jsxs)("div",{className:"block-item chart-block latest-7-days-pv",children:[Object(D.jsx)("h3",{children:"\u6700\u8fd17\u5929PV\u6570\u636e"}),Object(D.jsx)("div",{className:"desc",children:Object(D.jsx)("p",{children:"PV: Page View\u3002\u5373\u9875\u9762\u6d4f\u89c8\u91cf\u6216\u70b9\u51fb\u91cf\u3002"})}),Object(D.jsx)($,{data:{source:g},source:g,position:"date*pv",width:"100%",height:"300px",alias:{y:"\u65e5PV"}})]}),Object(D.jsxs)("div",{className:"block-item chart-block latest-7-days-pv",children:[Object(D.jsx)("h3",{children:"\u6700\u8fd17\u5929\u8bc4\u8bba\u6570\u636e"}),Object(D.jsx)($,{data:{source:N},source:N,position:"date*count",width:"100%",height:"300px",alias:{y:"\u65e5\u8bc4\u8bba"}})]})]})}n(182);var le=function(){var e=Object(a.useState)(!1),t=Object(s.a)(e,2),n=t[0],i=t[1];return Object(D.jsx)("div",{className:"App",children:Object(D.jsxs)("div",{className:"container",children:[!n&&Object(D.jsx)(Y,{onLogin:function(){i(!0)}}),n&&Object(D.jsx)(ue,{})]})})},de=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,235)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),a(e),i(e),r(e),c(e)}))};c.a.render(Object(D.jsx)(i.a.StrictMode,{children:Object(D.jsx)(le,{})}),document.getElementById("root")),de()}},[[183,1,2]]]);
//# sourceMappingURL=main.88240393.chunk.js.map