(this["webpackJsonpmedieval-china-admin"]=this["webpackJsonpmedieval-china-admin"]||[]).push([[0],{76:function(e,t,n){},88:function(e,t,n){},89:function(e,t,n){},90:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(10),s=n.n(r),c=(n(76),n(15)),o=n(57),u=n(141),h=n(135),d=n(134),l=n(136),m=n(130),v=n(137),j=n(58),p=n.n(j),f=n(91),b=n(132),g=n(133),O=n(140),y=n(138),w=n(42),x=n.n(w),D=n(5);function Y(){return Object(D.jsxs)(f.a,{variant:"body2",color:"textSecondary",align:"center",children:["Copyright \xa9 ",Object(D.jsx)(m.a,{color:"inherit",href:"http://medieval-china.github.io/",children:"Medieval-China"})," ",(new Date).getFullYear(),"."]})}function C(e){return Object(D.jsx)(y.a,Object(o.a)({elevation:6,variant:"filled"},e))}var M=Object(b.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));function N(e){var t=M(),n=Object(a.useState)({open:!1,severity:"warning",message:""}),i=Object(c.a)(n,2),r=i[0],s=i[1],o=Object(a.useState)(),m=Object(c.a)(o,2),j=m[0],b=m[1],y=Object(a.useState)(),w=Object(c.a)(y,2),N=w[0],P=w[1],S=function(){s({open:!1,severity:r.severity,message:""})};return Object(D.jsxs)(g.a,{component:"main",maxWidth:"xs",children:[Object(D.jsx)(d.a,{}),Object(D.jsxs)("div",{className:t.paper,children:[Object(D.jsx)(u.a,{className:t.avatar,children:Object(D.jsx)(p.a,{})}),Object(D.jsx)(f.a,{component:"h1",variant:"h5",children:"Sign in"}),Object(D.jsxs)("form",{className:t.form,noValidate:!0,onSubmit:function(t,n){if(t.preventDefault(),j)if(N){var a=x()().format("YYYYMMDD");"admin"===j&&N===a?(s({open:!0,severity:"success",message:"\u767b\u5f55\u6210\u529f\uff5e"}),e.onLogin&&e.onLogin()):s({open:!0,severity:"warning",message:"\u8d26\u53f7\u540d\u6216\u5bc6\u7801\u9519\u8bef"})}else s({open:!0,severity:"warning",message:"\u8bf7\u8f93\u5165\u5bc6\u7801"});else s({open:!0,severity:"warning",message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"})},children:[Object(D.jsx)(l.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"username",label:"User Name",name:"username",autoComplete:"username",placeholder:"admin",onChange:function(e){return b(e.target.value)},autoFocus:!0}),Object(D.jsx)(l.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",onChange:function(e){return P(e.target.value)}}),Object(D.jsx)(h.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:t.submit,children:"Sign In"})]})]}),Object(D.jsx)(v.a,{mt:8,children:Object(D.jsx)(Y,{})}),Object(D.jsx)(O.a,{anchorOrigin:{vertical:"top",horizontal:"center"},autoHideDuration:1500,open:r.open,onClose:S,message:r.message,children:Object(D.jsxs)(C,{onClose:S,severity:r.severity,children:[r.message,"!"]})})]})}var P,S=n(36),E=n(47),k=n(48),T=n(50),R=n(49),H=n(59),L=n.n(H),K=function(e,t,n,a,i){a=a||0,i=i||0,this.identifier=t,this.target=e,this.clientX=n.clientX+a,this.clientY=n.clientY+i,this.screenX=n.screenX+a,this.screenY=n.screenY+i,this.pageX=n.pageX+a,this.pageY=n.pageY+i};function X(){var e=[];return e.item=function(e){return this[e]||null},e.identifiedTouch=function(e){return this[e+1]||null},e}function A(e){return function(t){1===t.which&&(("mousedown"===t.type||!P||P&&!P.dispatchEvent)&&(P=t.target),function(e,t){var n=document.createEvent("Event");n.initEvent(e,!0,!0),n.altKey=t.altKey,n.ctrlKey=t.ctrlKey,n.metaKey=t.metaKey,n.shiftKey=t.shiftKey,n.touches=q(t),n.targetTouches=q(t),n.changedTouches=W(t),P.dispatchEvent(n)}(e,t),"mouseup"===t.type&&(P=null))}}function W(e){var t=X();return t.push(new K(P,1,e,0,0)),t}function q(e){return"mouseup"===e.type?X():W(e)}function I(e){!function(){for(var e=[window,document.documentElement],t=["ontouchstart","ontouchmove","ontouchcancel","ontouchend"],n=0;n<e.length;n++)for(var a=0;a<t.length;a++)e[n]&&void 0===e[n][t[a]]&&(e[n][t[a]]=null)}(),e.addEventListener("mousedown",A("touchstart"),!0),e.addEventListener("mousemove",A("touchmove"),!0),e.addEventListener("mouseup",A("touchend"),!0)}I.multiTouchOffset=75;var V=I,F=function(e){Object(T.a)(n,e);var t=Object(R.a)(n);function n(){var e;Object(E.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).id="c".concat(Math.random().toString(36).substring(7)),e.state={isRender:!1},e.chart=null,e.init=function(t){var n=e.props,a=n.width,i=void 0===a?t.width:a,r=n.height,s=void 0===r?t.height:r,c=n.creator,o=n.data,u=new L.a.Chart({id:e.id,width:i,height:s,pixelRatio:window.devicePixelRatio,appendPadding:[10,20,6,0]});c({chart:u,data:o,alias:o.alias}),e.chart=u},e.getParentRect=function(){var t=e.canvas.parentElement;if(t){var n=t.getBoundingClientRect(),a=n.width,i=n.height;return V(e.canvas),e.setState({isRender:!0}),{width:a,height:i}}return e.setState({isRender:!1}),{}},e}return Object(k.a)(n,[{key:"componentDidMount",value:function(){var e=this.getParentRect(),t=e.width,n=e.height;this.init({width:t,height:n})}},{key:"componentDidUpdate",value:function(){if(this.state.isRender){var e=this.getParentRect(),t=e.width,n=e.height;this.init({width:t,height:n})}}},{key:"componentWillUnmount",value:function(){this.chart.destroy(),this.chart=null}},{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){var e=this;return Object(D.jsx)("canvas",{id:this.id,ref:function(t){e.canvas=t}})}}]),n}(a.Component),Q="100%",U="100%",B=function(e){Object(T.a)(n,e);var t=Object(R.a)(n);function n(){var e;Object(E.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).creator=function(e){var t,n=e.chart,a=e.data,i=e.alias,r=a.source,s=a.position,o=s.split("*"),u=Object(c.a)(o,2),h=u[0],d=u[1];n.source(r,(t={},Object(S.a)(t,h,{type:"timeCat",mask:"MM/DD",tickCount:7,range:[0,1]}),Object(S.a)(t,d,{tickCount:6,min:0,alias:i.y}),t)),n.tooltip({showCrosshairs:!0}),n.line().position(s).shape("smooth").color("#3da742"),n.point().position(s).shape("smooth").color("#3da742").style({stroke:"#fff",lineWidth:1}),n.render()},e}return Object(k.a)(n,[{key:"render",value:function(){var e=this.props,t=e.source,n=void 0===t?[]:t,a=e.position,i=e.width,r=e.height,s=e.alias,c=void 0===s?{}:s,o={width:i||Q,height:r||U};return Object(D.jsx)("div",{className:"jsChartWrap",style:o,children:n.length?Object(D.jsx)(F,{data:{source:n,position:a,alias:c},creator:this.creator}):null})}}]),n}(a.PureComponent),z=n(51);function J(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7,t=[],n=e-1;n>=0;n--){var a=x()().subtract(n,"day");t.push({start:a.startOf("date"),end:a.endOf("date")})}return t}var G=window.AV,Z="RE2X3iYzmzwAjkv8WXLYyf1e-MdYXbMMI",$="yv3AoBegr8qvDisOGH4JqS8y",_="https://us.leancloud.cn/";function ee(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(t.require,t.startDate),a=t.endDate,i=[],r=new G.Query(e).notEqualTo("objectId","");if(i.push(r),n){var s=new G.Query(e);s.greaterThanOrEqualTo("createdAt",new Date(n)),i.push(s)}if(a){var c=new G.Query(e);c.lessThan("createdAt",new Date(a)),i.push(c)}return i}function te(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.startDate,a=t.endDate,i=ee("Counter",{startDate:n,endDate:a}),r=(e=G.Query).and.apply(e,Object(z.a)(i));return new Promise((function(e){r.count().then((function(t){return e(t)}))}))}function ne(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.startDate,a=t.endDate,i=ee("Comment",{startDate:n,endDate:a}),r=(e=G.Query).and.apply(e,Object(z.a)(i));return new Promise((function(e){r.count().then((function(t){return e(t)}))}))}G.init({appId:Z,appKey:$,serverURLs:_});n(88);function ae(){var e=Object(a.useState)(0),t=Object(c.a)(e,2),n=t[0],i=t[1],r=Object(a.useState)(0),s=Object(c.a)(r,2),o=s[0],u=s[1],h=Object(a.useState)([]),d=Object(c.a)(h,2),l=d[0],m=d[1],v=Object(a.useState)([]),j=Object(c.a)(v,2),p=j[0],f=j[1];return Object(a.useEffect)((function(){te().then((function(e){i(e)})),ne().then((function(e){u(e)})),setTimeout((function(){(function(){var e=J(),t=[];return e.forEach((function(e){var n=e.start,a=e.end,i=n.format("YYYY-MM-DD HH:mm:ss"),r=a.format("YYYY-MM-DD HH:mm:ss"),s=te({startDate:i,endDate:r});t.push(s.then((function(e){return{startDate:i,endDate:r,date:n.format("YYYY-MM-DD"),pv:e}})))})),Promise.all(t).then((function(e,t){return e}))})().then((function(e){m(e)}))}),100),setTimeout((function(){(function(){var e=J(),t=[];return e.forEach((function(e){var n=e.start,a=e.end,i=n.format("YYYY-MM-DD HH:mm:ss"),r=a.format("YYYY-MM-DD HH:mm:ss"),s=ne({startDate:i,endDate:r});t.push(s.then((function(e){return{startDate:i,endDate:r,date:n.format("YYYY-MM-DD"),count:e}})))})),Promise.all(t).then((function(e,t){return e}))})().then((function(e){f(e)}))}),500)}),[]),Object(D.jsxs)("div",{className:"dashboard-wrapper",children:[Object(D.jsx)("div",{className:"title",children:Object(D.jsx)("h3",{children:"\u540e\u53f0\u6570\u636e - \u4e2d\u56fd\u7684\u4e2d\u53e4"})}),Object(D.jsxs)("div",{className:"overview",children:[Object(D.jsxs)("div",{className:"line",children:["\u603bPV: ",Object(D.jsx)("span",{className:"count",children:n})]}),Object(D.jsxs)("div",{className:"line",children:["\u603b\u8bc4\u8bba\u6570: ",Object(D.jsx)("span",{className:"count",children:o})]})]}),Object(D.jsxs)("div",{className:"chart-block latest-7-days-pv",children:[Object(D.jsx)("h3",{children:"\u6700\u8fd17\u5929PV\u6570\u636e"}),Object(D.jsx)("div",{className:"desc",children:Object(D.jsx)("p",{children:"PV: Page View\u3002\u5373\u9875\u9762\u6d4f\u89c8\u91cf\u6216\u70b9\u51fb\u91cf\u3002"})}),Object(D.jsx)(B,{data:{source:l},source:l,position:"date*pv",width:"100%",height:"300px",alias:{y:"\u65e5PV"}})]}),Object(D.jsxs)("div",{className:"chart-block latest-7-days-pv",children:[Object(D.jsx)("h3",{children:"\u6700\u8fd17\u5929\u8bc4\u8bba\u6570\u636e"}),Object(D.jsx)(B,{data:{source:p},source:p,position:"date*count",width:"100%",height:"300px",alias:{y:"\u65e5\u8bc4\u8bba"}})]})]})}n(89);var ie=function(){var e=Object(a.useState)(!1),t=Object(c.a)(e,2),n=t[0],i=t[1];return Object(D.jsx)("div",{className:"App",children:Object(D.jsxs)("div",{className:"container",children:[!n&&Object(D.jsx)(N,{onLogin:function(){i(!0)}}),n&&Object(D.jsx)(ae,{})]})})},re=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,143)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),a(e),i(e),r(e),s(e)}))};s.a.render(Object(D.jsx)(i.a.StrictMode,{children:Object(D.jsx)(ie,{})}),document.getElementById("root")),re()}},[[90,1,2]]]);
//# sourceMappingURL=main.c581f598.chunk.js.map